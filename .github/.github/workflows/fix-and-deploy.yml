name: ü§ñ Fix & Deploy Bot

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: write    # Pro commit oprav
  pages: write       # Pro deploy na GitHub Pages
  id-token: write    # Pro autentizaci p≈ôi deploy

jobs:
  fix-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout k√≥du
        uses: actions/checkout@v4

      - name: Nastaven√≠ Pythonu
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Instalace z√°vislost√≠
        run: |
          pip install requests

      - name: Spu≈°tƒõn√≠ Fix-It Bota
        run: |
          python fix-it-bot.py

      - name: Commit a push oprav (pokud nƒõjak√© jsou)
        run: |
          git config --global user.name "FixBot"
          git config --global user.email "fixbot@users.noreply.github.com"
          git add .
          if ! git diff --cached --quiet; then
            git commit -m "ü§ñ Auto-fix: obr√°zky, meta tagy, favicon"
            git push
            echo "‚úÖ Zmƒõny byly commitnuty a pushnuty."
          else
            echo "‚ÑπÔ∏è  ≈Ω√°dn√© zmƒõny k commitnut√≠."
          fi

      - name: Konfigurace GitHub Pages
        uses: actions/configure-pages@v3

      - name: P≈ô√≠prava artifactu pro Pages
        uses: actions/upload-pages-artifact@v2
        with:
          path: './'

      - name: Nasazen√≠ na GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v3
